{"ast":null,"code":"/**\n * @module ol/renderer/Composite\n */\nimport BaseVectorLayer from '../layer/BaseVector.js';\nimport MapRenderer from './Map.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport RenderEvent from '../render/Event.js';\nimport RenderEventType from '../render/EventType.js';\nimport { CLASS_UNSELECTABLE } from '../css.js';\nimport { checkedFonts } from '../render/canvas.js';\nimport { inView } from '../layer/Layer.js';\nimport { listen, unlistenByKey } from '../events.js';\nimport { replaceChildren } from '../dom.js';\n/**\n * @classdesc\n * Canvas map renderer.\n * @api\n */\n\nclass CompositeMapRenderer extends MapRenderer {\n  /**\n   * @param {import(\"../Map.js\").default} map Map.\n   */\n  constructor(map) {\n    super(map);\n    /**\n     * @type {import(\"../events.js\").EventsKey}\n     */\n\n    this.fontChangeListenerKey_ = listen(checkedFonts, ObjectEventType.PROPERTYCHANGE, map.redrawText.bind(map));\n    /**\n     * @private\n     * @type {HTMLDivElement}\n     */\n\n    this.element_ = document.createElement('div');\n    const style = this.element_.style;\n    style.position = 'absolute';\n    style.width = '100%';\n    style.height = '100%';\n    style.zIndex = '0';\n    this.element_.className = CLASS_UNSELECTABLE + ' ol-layers';\n    const container = map.getViewport();\n    container.insertBefore(this.element_, container.firstChild || null);\n    /**\n     * @private\n     * @type {Array<HTMLElement>}\n     */\n\n    this.children_ = [];\n    /**\n     * @private\n     * @type {boolean}\n     */\n\n    this.renderedVisible_ = true;\n  }\n  /**\n   * @param {import(\"../render/EventType.js\").default} type Event type.\n   * @param {import(\"../Map.js\").FrameState} frameState Frame state.\n   */\n\n\n  dispatchRenderEvent(type, frameState) {\n    const map = this.getMap();\n\n    if (map.hasListener(type)) {\n      const event = new RenderEvent(type, undefined, frameState);\n      map.dispatchEvent(event);\n    }\n  }\n\n  disposeInternal() {\n    unlistenByKey(this.fontChangeListenerKey_);\n    this.element_.parentNode.removeChild(this.element_);\n    super.disposeInternal();\n  }\n  /**\n   * Render.\n   * @param {?import(\"../Map.js\").FrameState} frameState Frame state.\n   */\n\n\n  renderFrame(frameState) {\n    if (!frameState) {\n      if (this.renderedVisible_) {\n        this.element_.style.display = 'none';\n        this.renderedVisible_ = false;\n      }\n\n      return;\n    }\n\n    this.calculateMatrices2D(frameState);\n    this.dispatchRenderEvent(RenderEventType.PRECOMPOSE, frameState);\n    const layerStatesArray = frameState.layerStatesArray.sort(function (a, b) {\n      return a.zIndex - b.zIndex;\n    });\n    const declutter = layerStatesArray.some(layerState => layerState.layer instanceof BaseVectorLayer && layerState.layer.getDeclutter());\n\n    if (declutter) {\n      // Some layers need decluttering, turn on deferred rendering hint\n      frameState.declutter = {};\n    }\n\n    const viewState = frameState.viewState;\n    this.children_.length = 0;\n    const renderedLayerStates = [];\n    let previousElement = null;\n\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      const layerState = layerStatesArray[i];\n      frameState.layerIndex = i;\n      const layer = layerState.layer;\n      const sourceState = layer.getSourceState();\n\n      if (!inView(layerState, viewState) || sourceState != 'ready' && sourceState != 'undefined') {\n        layer.unrender();\n        continue;\n      }\n\n      const element = layer.render(frameState, previousElement);\n\n      if (!element) {\n        continue;\n      }\n\n      if (element !== previousElement) {\n        this.children_.push(element);\n        previousElement = element;\n      }\n\n      renderedLayerStates.push(layerState);\n    }\n\n    this.declutter(frameState, renderedLayerStates);\n    replaceChildren(this.element_, this.children_);\n    this.dispatchRenderEvent(RenderEventType.POSTCOMPOSE, frameState);\n\n    if (!this.renderedVisible_) {\n      this.element_.style.display = '';\n      this.renderedVisible_ = true;\n    }\n\n    this.scheduleExpireIconCache(frameState);\n  }\n  /**\n   * @param {import(\"../Map.js\").FrameState} frameState Frame state.\n   * @param {Array<import('../layer/Layer.js').State>} layerStates Layers.\n   */\n\n\n  declutter(frameState, layerStates) {\n    if (!frameState.declutter) {\n      return;\n    }\n\n    for (let i = layerStates.length - 1; i >= 0; --i) {\n      const layerState = layerStates[i];\n      const layer = layerState.layer;\n\n      if (layer.getDeclutter()) {\n        layer.renderDeclutter(frameState, layerState);\n      }\n    }\n\n    layerStates.forEach(layerState => layerState.layer.renderDeferred(frameState));\n  }\n\n}\n\nexport default CompositeMapRenderer;","map":{"version":3,"names":["BaseVectorLayer","MapRenderer","ObjectEventType","RenderEvent","RenderEventType","CLASS_UNSELECTABLE","checkedFonts","inView","listen","unlistenByKey","replaceChildren","CompositeMapRenderer","constructor","map","fontChangeListenerKey_","PROPERTYCHANGE","redrawText","bind","element_","document","createElement","style","position","width","height","zIndex","className","container","getViewport","insertBefore","firstChild","children_","renderedVisible_","dispatchRenderEvent","type","frameState","getMap","hasListener","event","undefined","dispatchEvent","disposeInternal","parentNode","removeChild","renderFrame","display","calculateMatrices2D","PRECOMPOSE","layerStatesArray","sort","a","b","declutter","some","layerState","layer","getDeclutter","viewState","length","renderedLayerStates","previousElement","i","ii","layerIndex","sourceState","getSourceState","unrender","element","render","push","POSTCOMPOSE","scheduleExpireIconCache","layerStates","renderDeclutter","forEach","renderDeferred"],"sources":["/home/jce/Web Dev Space/Syncsequence/frontEnd/node_modules/ol/renderer/Composite.js"],"sourcesContent":["/**\n * @module ol/renderer/Composite\n */\nimport BaseVectorLayer from '../layer/BaseVector.js';\nimport MapRenderer from './Map.js';\nimport ObjectEventType from '../ObjectEventType.js';\nimport RenderEvent from '../render/Event.js';\nimport RenderEventType from '../render/EventType.js';\nimport {CLASS_UNSELECTABLE} from '../css.js';\nimport {checkedFonts} from '../render/canvas.js';\nimport {inView} from '../layer/Layer.js';\nimport {listen, unlistenByKey} from '../events.js';\nimport {replaceChildren} from '../dom.js';\n\n/**\n * @classdesc\n * Canvas map renderer.\n * @api\n */\nclass CompositeMapRenderer extends MapRenderer {\n  /**\n   * @param {import(\"../Map.js\").default} map Map.\n   */\n  constructor(map) {\n    super(map);\n\n    /**\n     * @type {import(\"../events.js\").EventsKey}\n     */\n    this.fontChangeListenerKey_ = listen(\n      checkedFonts,\n      ObjectEventType.PROPERTYCHANGE,\n      map.redrawText.bind(map),\n    );\n\n    /**\n     * @private\n     * @type {HTMLDivElement}\n     */\n    this.element_ = document.createElement('div');\n    const style = this.element_.style;\n    style.position = 'absolute';\n    style.width = '100%';\n    style.height = '100%';\n    style.zIndex = '0';\n\n    this.element_.className = CLASS_UNSELECTABLE + ' ol-layers';\n\n    const container = map.getViewport();\n    container.insertBefore(this.element_, container.firstChild || null);\n\n    /**\n     * @private\n     * @type {Array<HTMLElement>}\n     */\n    this.children_ = [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.renderedVisible_ = true;\n  }\n\n  /**\n   * @param {import(\"../render/EventType.js\").default} type Event type.\n   * @param {import(\"../Map.js\").FrameState} frameState Frame state.\n   */\n  dispatchRenderEvent(type, frameState) {\n    const map = this.getMap();\n    if (map.hasListener(type)) {\n      const event = new RenderEvent(type, undefined, frameState);\n      map.dispatchEvent(event);\n    }\n  }\n\n  disposeInternal() {\n    unlistenByKey(this.fontChangeListenerKey_);\n    this.element_.parentNode.removeChild(this.element_);\n    super.disposeInternal();\n  }\n\n  /**\n   * Render.\n   * @param {?import(\"../Map.js\").FrameState} frameState Frame state.\n   */\n  renderFrame(frameState) {\n    if (!frameState) {\n      if (this.renderedVisible_) {\n        this.element_.style.display = 'none';\n        this.renderedVisible_ = false;\n      }\n      return;\n    }\n\n    this.calculateMatrices2D(frameState);\n    this.dispatchRenderEvent(RenderEventType.PRECOMPOSE, frameState);\n\n    const layerStatesArray = frameState.layerStatesArray.sort(function (a, b) {\n      return a.zIndex - b.zIndex;\n    });\n    const declutter = layerStatesArray.some(\n      (layerState) =>\n        layerState.layer instanceof BaseVectorLayer &&\n        layerState.layer.getDeclutter(),\n    );\n    if (declutter) {\n      // Some layers need decluttering, turn on deferred rendering hint\n      frameState.declutter = {};\n    }\n    const viewState = frameState.viewState;\n\n    this.children_.length = 0;\n\n    const renderedLayerStates = [];\n    let previousElement = null;\n    for (let i = 0, ii = layerStatesArray.length; i < ii; ++i) {\n      const layerState = layerStatesArray[i];\n      frameState.layerIndex = i;\n\n      const layer = layerState.layer;\n      const sourceState = layer.getSourceState();\n      if (\n        !inView(layerState, viewState) ||\n        (sourceState != 'ready' && sourceState != 'undefined')\n      ) {\n        layer.unrender();\n        continue;\n      }\n\n      const element = layer.render(frameState, previousElement);\n      if (!element) {\n        continue;\n      }\n      if (element !== previousElement) {\n        this.children_.push(element);\n        previousElement = element;\n      }\n\n      renderedLayerStates.push(layerState);\n    }\n\n    this.declutter(frameState, renderedLayerStates);\n\n    replaceChildren(this.element_, this.children_);\n\n    this.dispatchRenderEvent(RenderEventType.POSTCOMPOSE, frameState);\n\n    if (!this.renderedVisible_) {\n      this.element_.style.display = '';\n      this.renderedVisible_ = true;\n    }\n\n    this.scheduleExpireIconCache(frameState);\n  }\n\n  /**\n   * @param {import(\"../Map.js\").FrameState} frameState Frame state.\n   * @param {Array<import('../layer/Layer.js').State>} layerStates Layers.\n   */\n  declutter(frameState, layerStates) {\n    if (!frameState.declutter) {\n      return;\n    }\n    for (let i = layerStates.length - 1; i >= 0; --i) {\n      const layerState = layerStates[i];\n      const layer = layerState.layer;\n      if (layer.getDeclutter()) {\n        layer.renderDeclutter(frameState, layerState);\n      }\n    }\n    layerStates.forEach((layerState) =>\n      layerState.layer.renderDeferred(frameState),\n    );\n  }\n}\n\nexport default CompositeMapRenderer;\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,eAAP,MAA4B,wBAA5B;AACA,OAAOC,WAAP,MAAwB,UAAxB;AACA,OAAOC,eAAP,MAA4B,uBAA5B;AACA,OAAOC,WAAP,MAAwB,oBAAxB;AACA,OAAOC,eAAP,MAA4B,wBAA5B;AACA,SAAQC,kBAAR,QAAiC,WAAjC;AACA,SAAQC,YAAR,QAA2B,qBAA3B;AACA,SAAQC,MAAR,QAAqB,mBAArB;AACA,SAAQC,MAAR,EAAgBC,aAAhB,QAAoC,cAApC;AACA,SAAQC,eAAR,QAA8B,WAA9B;AAEA;AACA;AACA;AACA;AACA;;AACA,MAAMC,oBAAN,SAAmCV,WAAnC,CAA+C;EAC7C;AACF;AACA;EACEW,WAAW,CAACC,GAAD,EAAM;IACf,MAAMA,GAAN;IAEA;AACJ;AACA;;IACI,KAAKC,sBAAL,GAA8BN,MAAM,CAClCF,YADkC,EAElCJ,eAAe,CAACa,cAFkB,EAGlCF,GAAG,CAACG,UAAJ,CAAeC,IAAf,CAAoBJ,GAApB,CAHkC,CAApC;IAMA;AACJ;AACA;AACA;;IACI,KAAKK,QAAL,GAAgBC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAhB;IACA,MAAMC,KAAK,GAAG,KAAKH,QAAL,CAAcG,KAA5B;IACAA,KAAK,CAACC,QAAN,GAAiB,UAAjB;IACAD,KAAK,CAACE,KAAN,GAAc,MAAd;IACAF,KAAK,CAACG,MAAN,GAAe,MAAf;IACAH,KAAK,CAACI,MAAN,GAAe,GAAf;IAEA,KAAKP,QAAL,CAAcQ,SAAd,GAA0BrB,kBAAkB,GAAG,YAA/C;IAEA,MAAMsB,SAAS,GAAGd,GAAG,CAACe,WAAJ,EAAlB;IACAD,SAAS,CAACE,YAAV,CAAuB,KAAKX,QAA5B,EAAsCS,SAAS,CAACG,UAAV,IAAwB,IAA9D;IAEA;AACJ;AACA;AACA;;IACI,KAAKC,SAAL,GAAiB,EAAjB;IAEA;AACJ;AACA;AACA;;IACI,KAAKC,gBAAL,GAAwB,IAAxB;EACD;EAED;AACF;AACA;AACA;;;EACEC,mBAAmB,CAACC,IAAD,EAAOC,UAAP,EAAmB;IACpC,MAAMtB,GAAG,GAAG,KAAKuB,MAAL,EAAZ;;IACA,IAAIvB,GAAG,CAACwB,WAAJ,CAAgBH,IAAhB,CAAJ,EAA2B;MACzB,MAAMI,KAAK,GAAG,IAAInC,WAAJ,CAAgB+B,IAAhB,EAAsBK,SAAtB,EAAiCJ,UAAjC,CAAd;MACAtB,GAAG,CAAC2B,aAAJ,CAAkBF,KAAlB;IACD;EACF;;EAEDG,eAAe,GAAG;IAChBhC,aAAa,CAAC,KAAKK,sBAAN,CAAb;IACA,KAAKI,QAAL,CAAcwB,UAAd,CAAyBC,WAAzB,CAAqC,KAAKzB,QAA1C;IACA,MAAMuB,eAAN;EACD;EAED;AACF;AACA;AACA;;;EACEG,WAAW,CAACT,UAAD,EAAa;IACtB,IAAI,CAACA,UAAL,EAAiB;MACf,IAAI,KAAKH,gBAAT,EAA2B;QACzB,KAAKd,QAAL,CAAcG,KAAd,CAAoBwB,OAApB,GAA8B,MAA9B;QACA,KAAKb,gBAAL,GAAwB,KAAxB;MACD;;MACD;IACD;;IAED,KAAKc,mBAAL,CAAyBX,UAAzB;IACA,KAAKF,mBAAL,CAAyB7B,eAAe,CAAC2C,UAAzC,EAAqDZ,UAArD;IAEA,MAAMa,gBAAgB,GAAGb,UAAU,CAACa,gBAAX,CAA4BC,IAA5B,CAAiC,UAAUC,CAAV,EAAaC,CAAb,EAAgB;MACxE,OAAOD,CAAC,CAACzB,MAAF,GAAW0B,CAAC,CAAC1B,MAApB;IACD,CAFwB,CAAzB;IAGA,MAAM2B,SAAS,GAAGJ,gBAAgB,CAACK,IAAjB,CACfC,UAAD,IACEA,UAAU,CAACC,KAAX,YAA4BvD,eAA5B,IACAsD,UAAU,CAACC,KAAX,CAAiBC,YAAjB,EAHc,CAAlB;;IAKA,IAAIJ,SAAJ,EAAe;MACb;MACAjB,UAAU,CAACiB,SAAX,GAAuB,EAAvB;IACD;;IACD,MAAMK,SAAS,GAAGtB,UAAU,CAACsB,SAA7B;IAEA,KAAK1B,SAAL,CAAe2B,MAAf,GAAwB,CAAxB;IAEA,MAAMC,mBAAmB,GAAG,EAA5B;IACA,IAAIC,eAAe,GAAG,IAAtB;;IACA,KAAK,IAAIC,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAGd,gBAAgB,CAACU,MAAtC,EAA8CG,CAAC,GAAGC,EAAlD,EAAsD,EAAED,CAAxD,EAA2D;MACzD,MAAMP,UAAU,GAAGN,gBAAgB,CAACa,CAAD,CAAnC;MACA1B,UAAU,CAAC4B,UAAX,GAAwBF,CAAxB;MAEA,MAAMN,KAAK,GAAGD,UAAU,CAACC,KAAzB;MACA,MAAMS,WAAW,GAAGT,KAAK,CAACU,cAAN,EAApB;;MACA,IACE,CAAC1D,MAAM,CAAC+C,UAAD,EAAaG,SAAb,CAAP,IACCO,WAAW,IAAI,OAAf,IAA0BA,WAAW,IAAI,WAF5C,EAGE;QACAT,KAAK,CAACW,QAAN;QACA;MACD;;MAED,MAAMC,OAAO,GAAGZ,KAAK,CAACa,MAAN,CAAajC,UAAb,EAAyByB,eAAzB,CAAhB;;MACA,IAAI,CAACO,OAAL,EAAc;QACZ;MACD;;MACD,IAAIA,OAAO,KAAKP,eAAhB,EAAiC;QAC/B,KAAK7B,SAAL,CAAesC,IAAf,CAAoBF,OAApB;QACAP,eAAe,GAAGO,OAAlB;MACD;;MAEDR,mBAAmB,CAACU,IAApB,CAAyBf,UAAzB;IACD;;IAED,KAAKF,SAAL,CAAejB,UAAf,EAA2BwB,mBAA3B;IAEAjD,eAAe,CAAC,KAAKQ,QAAN,EAAgB,KAAKa,SAArB,CAAf;IAEA,KAAKE,mBAAL,CAAyB7B,eAAe,CAACkE,WAAzC,EAAsDnC,UAAtD;;IAEA,IAAI,CAAC,KAAKH,gBAAV,EAA4B;MAC1B,KAAKd,QAAL,CAAcG,KAAd,CAAoBwB,OAApB,GAA8B,EAA9B;MACA,KAAKb,gBAAL,GAAwB,IAAxB;IACD;;IAED,KAAKuC,uBAAL,CAA6BpC,UAA7B;EACD;EAED;AACF;AACA;AACA;;;EACEiB,SAAS,CAACjB,UAAD,EAAaqC,WAAb,EAA0B;IACjC,IAAI,CAACrC,UAAU,CAACiB,SAAhB,EAA2B;MACzB;IACD;;IACD,KAAK,IAAIS,CAAC,GAAGW,WAAW,CAACd,MAAZ,GAAqB,CAAlC,EAAqCG,CAAC,IAAI,CAA1C,EAA6C,EAAEA,CAA/C,EAAkD;MAChD,MAAMP,UAAU,GAAGkB,WAAW,CAACX,CAAD,CAA9B;MACA,MAAMN,KAAK,GAAGD,UAAU,CAACC,KAAzB;;MACA,IAAIA,KAAK,CAACC,YAAN,EAAJ,EAA0B;QACxBD,KAAK,CAACkB,eAAN,CAAsBtC,UAAtB,EAAkCmB,UAAlC;MACD;IACF;;IACDkB,WAAW,CAACE,OAAZ,CAAqBpB,UAAD,IAClBA,UAAU,CAACC,KAAX,CAAiBoB,cAAjB,CAAgCxC,UAAhC,CADF;EAGD;;AA3J4C;;AA8J/C,eAAexB,oBAAf"},"metadata":{},"sourceType":"module"}